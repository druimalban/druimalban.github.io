<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="recursr">
<title>Morphisms for a list • recursr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Morphisms for a list">
<meta property="og:description" content="recursr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">recursr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/fixed-point-programming.html">Programming with fixed-points</a>
    <a class="dropdown-item" href="../articles/list-morphisms.html">Morphisms for a list</a>
    <a class="dropdown-item" href="../articles/tree-morphisms.html">Morphisms for a tree</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Morphisms for a list</h1>
            
      
      
      <div class="d-none name"><code>list-morphisms.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="folds">Folds<a class="anchor" aria-label="anchor" href="#folds"></a>
</h2>
<div class="section level3">
<h3 id="catamorphism">Catamorphism<a class="anchor" aria-label="anchor" href="#catamorphism"></a>
</h3>
<p>The catamorphism is a universal abstraction for tearing down a
functor structure.</p>
<p>With simple recursion is feasible to print a list as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">printListSimple</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">lst</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span> <span class="op">(</span><span class="va">lst</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="st">"nil"</span><span class="op">)</span></span>
<span>    <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="va">topNode</span>  <span class="op">=</span> <span class="va">lst</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>        <span class="va">allNodes</span> <span class="op">=</span> <span class="va">lst</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span> <span class="op">(</span><span class="va">topNode</span>, <span class="st">": "</span>, <span class="fu">printListSimple</span> <span class="op">(</span><span class="va">allNodes</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">''</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">printListSimple</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "1: 2: 3: 4: 5: 6: 7: 8: 9: 10: nil"</span></span></code></pre></div>
<p>This can be rewritten with a catamorphism:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">printListCata</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">lst</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">alg</span> <span class="op">=</span> <span class="kw">function</span> <span class="op">(</span><span class="va">l</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="../reference/is.NilF.html">is.NilF</a></span> <span class="op">(</span><span class="va">l</span><span class="op">)</span><span class="op">)</span></span>
<span>            <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="st">"nil"</span><span class="op">)</span> </span>
<span>        <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="../reference/is.ConsF.html">is.ConsF</a></span> <span class="op">(</span><span class="va">l</span><span class="op">)</span><span class="op">)</span></span>
<span>            <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span> <span class="op">(</span><span class="va">l</span><span class="op">$</span><span class="va">attr</span>, <span class="st">": "</span>, <span class="va">l</span><span class="op">$</span><span class="va">carrier</span>, sep<span class="op">=</span><span class="st">''</span>, collapse<span class="op">=</span><span class="st">''</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="fu"><a href="../reference/cata.html">cata</a></span> <span class="op">(</span><span class="va">alg</span>, <span class="va">lst</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">printListCata</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "1: 2: 3: 4: 5: 6: 7: 8: 9: 10: nil"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="paramorphism">Paramorphism<a class="anchor" aria-label="anchor" href="#paramorphism"></a>
</h3>
<p>The paramorphism is a variant of the catamorphism, one which provides
access to the current sub-structure at any given point. The algebra
needs to interpret tuples in the carrier type.</p>
<p>The following function appends the size of the sub-structure to the
end of each list element:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">printIndent</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">lst</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">alg</span> <span class="op">=</span> <span class="kw">function</span> <span class="op">(</span><span class="va">l</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="../reference/is.NilF.html">is.NilF</a></span> <span class="op">(</span><span class="va">l</span><span class="op">)</span><span class="op">)</span></span>
<span>            <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="kw">else</span> <span class="op">{</span></span>
<span>            <span class="va">x</span>  <span class="op">=</span> <span class="va">l</span><span class="op">$</span><span class="va">attr</span></span>
<span>            <span class="va">xs</span> <span class="op">=</span> <span class="va">l</span><span class="op">$</span><span class="va">carrier</span></span>
<span>            <span class="va">xsa</span> <span class="op">=</span> <span class="fu"><a href="../reference/first.html">first</a></span> <span class="op">(</span><span class="va">xs</span><span class="op">)</span></span>
<span>            <span class="va">xsc</span> <span class="op">=</span> <span class="fu"><a href="../reference/second.html">second</a></span> <span class="op">(</span><span class="va">xs</span><span class="op">)</span></span>
<span></span>
<span>            <span class="va">indent</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span> <span class="op">(</span><span class="va">xsa</span><span class="op">)</span>, <span class="st">'&gt;'</span><span class="op">)</span></span>
<span>            <span class="va">pasted</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span> <span class="op">(</span><span class="va">indent</span>, sep<span class="op">=</span><span class="st">''</span>, collapse<span class="op">=</span><span class="st">''</span><span class="op">)</span></span>
<span>            </span>
<span>            <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span> <span class="op">(</span><span class="va">xsc</span></span>
<span>                          , <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span> <span class="op">(</span><span class="va">x</span>, <span class="va">pasted</span>, sep<span class="op">=</span><span class="st">''</span><span class="op">)</span></span>
<span>                          , after<span class="op">=</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="fu"><a href="../reference/para.html">para</a></span> <span class="op">(</span><span class="va">alg</span>, <span class="va">lst</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">printIndent</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span> <span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [1] "1&gt;&gt;&gt;"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; [1] "2&gt;&gt;"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; [1] "3&gt;"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]]</span></span>
<span><span class="co">#&gt; [1] "4"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="histomorphism">Histomorphism<a class="anchor" aria-label="anchor" href="#histomorphism"></a>
</h3>
<p>The histomorphism goes further still by providing access to all
previous values in the recursion. These are stored in a structure
provided by cofree, embedded throughout the list base functor’s
carrier.</p>
<p>The following function skips over elements at even indices. This
function is from <a href="https://jtobin.io/time-traveling-recursion" class="external-link uri">https://jtobin.io/time-traveling-recursion</a>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">currElement</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">l</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="va">l</span><span class="op">$</span><span class="va">attr</span><span class="op">)</span></span>
<span></span>
<span><span class="va">peelBack</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">l</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="va">l</span><span class="op">$</span><span class="va">carrier</span><span class="op">)</span></span>
<span></span>
<span><span class="va">oddIndices</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">lst</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">alg</span> <span class="op">=</span> <span class="kw">function</span> <span class="op">(</span><span class="va">l</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="../reference/is.NilF.html">is.NilF</a></span> <span class="op">(</span><span class="va">l</span><span class="op">)</span><span class="op">)</span></span>
<span>            <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="kw">else</span> <span class="op">{</span></span>
<span>            <span class="va">h0</span>  <span class="op">=</span> <span class="fu">currElement</span> <span class="op">(</span><span class="va">l</span><span class="op">)</span></span>
<span>            <span class="va">cf0</span> <span class="op">=</span> <span class="fu">peelBack</span> <span class="op">(</span><span class="va">l</span><span class="op">)</span></span>
<span>            <span class="va">xs0</span> <span class="op">=</span> <span class="fu">peelBack</span> <span class="op">(</span><span class="va">cf0</span><span class="op">)</span></span>
<span></span>
<span>            <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="../reference/is.NilF.html">is.NilF</a></span> <span class="op">(</span><span class="va">xs0</span><span class="op">)</span><span class="op">)</span></span>
<span>                <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span> <span class="op">(</span><span class="va">h0</span><span class="op">)</span><span class="op">)</span></span>
<span>            <span class="kw">else</span> <span class="op">{</span></span>
<span>                <span class="va">h1</span>  <span class="op">=</span> <span class="fu">currElement</span> <span class="op">(</span><span class="va">xs0</span><span class="op">)</span></span>
<span>                <span class="va">cf1</span> <span class="op">=</span> <span class="fu">peelBack</span> <span class="op">(</span><span class="va">xs0</span><span class="op">)</span></span>
<span>                <span class="va">t1</span>  <span class="op">=</span> <span class="fu">currElement</span> <span class="op">(</span><span class="va">cf1</span><span class="op">)</span></span>
<span></span>
<span>                <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">h0</span>, <span class="va">t1</span><span class="op">)</span><span class="op">)</span></span>
<span>            <span class="op">}</span>      </span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="fu"><a href="../reference/histo.html">histo</a></span> <span class="op">(</span><span class="va">alg</span>, <span class="va">lst</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">oddIndices</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]]</span></span>
<span><span class="co">#&gt; [1] 7</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[5]]</span></span>
<span><span class="co">#&gt; [1] 9</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="unfolds">Unfolds<a class="anchor" aria-label="anchor" href="#unfolds"></a>
</h2>
<div class="section level3">
<h3 id="anamorphism">Anamorphism<a class="anchor" aria-label="anchor" href="#anamorphism"></a>
</h3>
<p>The anamorphism is the categorical dual of the catamorphism. It
unfolds a structure into a list, rather than folding a list structure
into something else, i.e. it builds up a structure rather than tearing
it down like the catamorphism does.</p>
<p>The following functions are the equivalent of
<code>as.list(unlist(recursive=T))</code>. They build up a simple list
from a more complex structure, in this case a list of lists. Compare the
lack of recursive calls in the latter, to the former.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">collapseListsSimple</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">lst</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span> <span class="op">(</span><span class="va">lst</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span> <span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="va">x</span>  <span class="op">=</span> <span class="va">lst</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>        <span class="va">xs</span> <span class="op">=</span> <span class="va">lst</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span>        </span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">is.list</a></span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span> <span class="op">(</span><span class="va">xs</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span>            <span class="fu">collapseListsSimple</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>        <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">is.list</a></span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span> <span class="op">(</span><span class="va">xs</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span> <span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>        <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">is.list</a></span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span> <span class="op">(</span><span class="va">xs</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span> <span class="op">(</span><span class="fu">collapseListsSimple</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu">collapseListsSimple</span> <span class="op">(</span><span class="va">xs</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">is.list</a></span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span> <span class="op">(</span><span class="va">xs</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span> <span class="op">(</span><span class="fu">collapseListsSimple</span> <span class="op">(</span><span class="va">xs</span><span class="op">)</span>, <span class="va">x</span>, after<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">collapseListsSimple</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">8</span><span class="op">)</span>,<span class="fl">9</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">11</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]]</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[5]]</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[6]]</span></span>
<span><span class="co">#&gt; [1] 6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[7]]</span></span>
<span><span class="co">#&gt; [1] 7</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[8]]</span></span>
<span><span class="co">#&gt; [1] 8</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[9]]</span></span>
<span><span class="co">#&gt; [1] 9</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[10]]</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[11]]</span></span>
<span><span class="co">#&gt; [1] 11</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">collapseListsAna</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">lst</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">coalg</span> <span class="op">=</span> <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span>            <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="fu"><a href="../reference/NilF.html">NilF</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="kw">else</span> <span class="op">{</span></span>
<span>            <span class="va">x_</span> <span class="op">=</span> <span class="va">x</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>            <span class="va">xs</span> <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span>            <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span> <span class="op">(</span><span class="va">xs</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span>                 <span class="fu"><a href="../reference/ConsF.html">ConsF</a></span> <span class="op">(</span><span class="va">x_</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>            <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span> <span class="op">(</span><span class="va">xs</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span>                 <span class="fu"><a href="../reference/ConsF.html">ConsF</a></span> <span class="op">(</span><span class="va">x_</span>, <span class="va">xs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>            <span class="kw">else</span> <span class="fu"><a href="../reference/ConsF.html">ConsF</a></span> <span class="op">(</span><span class="va">x_</span>, <span class="va">xs</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="fu"><a href="../reference/ana.html">ana</a></span> <span class="op">(</span><span class="va">coalg</span>, <span class="va">lst</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">collapseListsAna</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">8</span><span class="op">)</span>,<span class="fl">9</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">11</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]]</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[5]]</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[6]]</span></span>
<span><span class="co">#&gt; [1] 6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[7]]</span></span>
<span><span class="co">#&gt; [1] 7</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[8]]</span></span>
<span><span class="co">#&gt; [1] 8</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[9]]</span></span>
<span><span class="co">#&gt; [1] 9</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[10]]</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[11]]</span></span>
<span><span class="co">#&gt; [1] 11</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="apomorphism">Apomorphism<a class="anchor" aria-label="anchor" href="#apomorphism"></a>
</h3>
<p>The apomorphism is the categorical dual of the paramorphism. It
allows the recursion to be terminated at any point.</p>
<p>The following function is an implementation of the tails function.
This function is designed returns a list of the tails of a given list as
the apomorphism traverses the list structure.</p>
<p>Note the use of <code><a href="../reference/Left.html">Left()</a></code> and <code><a href="../reference/Right.html">Right()</a></code>. If a
<code>Left</code> value is provided, the paramorphism will just return
whatever value is in there, i.e. we’ve stopped recursion. If a
<code>Right</code> value is provided, recursion continues.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tailsApo</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">lst</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">coalg</span> <span class="op">=</span> <span class="kw">function</span> <span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">projected</span> <span class="op">=</span> <span class="fu"><a href="../reference/project.html">project</a></span> <span class="op">(</span><span class="va">a</span><span class="op">)</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="../reference/is.NilF.html">is.NilF</a></span> <span class="op">(</span><span class="va">projected</span><span class="op">)</span><span class="op">)</span></span>
<span>            <span class="fu"><a href="../reference/ConsF.html">ConsF</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span> <span class="op">(</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="../reference/Left.html">Left</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span> <span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="kw">else</span> <span class="op">{</span></span>
<span>            <span class="va">xs</span> <span class="op">=</span> <span class="va">projected</span><span class="op">$</span><span class="va">carrier</span></span>
<span>            <span class="fu"><a href="../reference/ConsF.html">ConsF</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span> <span class="op">(</span><span class="va">a</span><span class="op">)</span>, <span class="fu"><a href="../reference/Right.html">Right</a></span> <span class="op">(</span><span class="va">xs</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="fu"><a href="../reference/apo.html">apo</a></span> <span class="op">(</span><span class="va">coalg</span>, <span class="va">lst</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">tailsApo</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span> <span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [[1]][[1]]</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]][[2]]</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]][[3]]</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]][[4]]</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]][[5]]</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; [[2]][[1]]</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]][[2]]</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]][[3]]</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]][[4]]</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; [[3]][[1]]</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]][[2]]</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]][[3]]</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]]</span></span>
<span><span class="co">#&gt; [[4]][[1]]</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]][[2]]</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[5]]</span></span>
<span><span class="co">#&gt; [[5]][[1]]</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[6]]</span></span>
<span><span class="co">#&gt; list()</span></span></code></pre></div>
<p>It’s not very useful here, but the function doesn’t have to stop on
the empty list. It can stop on arbitrary leading values, e.g. zero:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tailsApoZero</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">lst</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">coalg</span> <span class="op">=</span> <span class="kw">function</span> <span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">projected</span> <span class="op">=</span> <span class="fu"><a href="../reference/project.html">project</a></span> <span class="op">(</span><span class="va">a</span><span class="op">)</span></span>
<span>        </span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="va">projected</span><span class="op">$</span><span class="va">attr</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span>            <span class="fu"><a href="../reference/ConsF.html">ConsF</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span> <span class="op">(</span><span class="va">a</span><span class="op">)</span>, <span class="fu"><a href="../reference/Left.html">Left</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="../reference/is.NilF.html">is.NilF</a></span> <span class="op">(</span><span class="va">projected</span><span class="op">)</span><span class="op">)</span></span>
<span>            <span class="fu"><a href="../reference/ConsF.html">ConsF</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span> <span class="op">(</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="../reference/Left.html">Left</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span> <span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="kw">else</span> <span class="op">{</span></span>
<span>            <span class="va">xs</span> <span class="op">=</span> <span class="va">projected</span><span class="op">$</span><span class="va">carrier</span></span>
<span>            <span class="fu"><a href="../reference/ConsF.html">ConsF</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span> <span class="op">(</span><span class="va">a</span><span class="op">)</span>, <span class="fu"><a href="../reference/Right.html">Right</a></span> <span class="op">(</span><span class="va">xs</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="fu"><a href="../reference/apo.html">apo</a></span> <span class="op">(</span><span class="va">coalg</span>, <span class="va">lst</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">tailsApoZero</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span> <span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [[1]][[1]]</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]][[2]]</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]][[3]]</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]][[4]]</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]][[5]]</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; [[2]][[1]]</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]][[2]]</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]][[3]]</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]][[4]]</span></span>
<span><span class="co">#&gt; [1] 3</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="futumorphism">Futumorphism<a class="anchor" aria-label="anchor" href="#futumorphism"></a>
</h3>
<p>The futumorphism is the categorical dual of the histomorphism.
Instead of access to previously-computed answers, the futumorphism
provides access to values yet to be computed.</p>
<p>An implementation of the exchange function is given. This example as
usually implemented swaps pairs. This example instead swaps sets of
three as it shows better how to access the ‘future’ values. R lacks the
pattern matching which Haskell has; as such the Haskell equivalent is
much more succint.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exchange</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">lst</span><span class="op">)</span> <span class="op">{</span>    </span>
<span>    <span class="va">coalg</span> <span class="op">=</span> <span class="kw">function</span> <span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">projected</span> <span class="op">=</span> <span class="fu"><a href="../reference/project.html">project</a></span> <span class="op">(</span><span class="va">a</span><span class="op">)</span></span>
<span>        </span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="../reference/is.NilF.html">is.NilF</a></span> <span class="op">(</span><span class="va">projected</span><span class="op">)</span><span class="op">)</span></span>
<span>            <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="fu"><a href="../reference/NilF.html">NilF</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="kw">else</span> <span class="op">{</span></span>
<span>            <span class="va">x</span> <span class="op">=</span> <span class="va">projected</span><span class="op">$</span><span class="va">attr</span></span>
<span>            <span class="va">k</span> <span class="op">=</span> <span class="va">projected</span><span class="op">$</span><span class="va">carrier</span></span>
<span>            <span class="va">projected_</span> <span class="op">=</span> <span class="fu"><a href="../reference/project.html">project</a></span> <span class="op">(</span><span class="va">k</span><span class="op">)</span></span>
<span>  </span>
<span>            <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="../reference/is.NilF.html">is.NilF</a></span> <span class="op">(</span><span class="va">projected_</span><span class="op">)</span><span class="op">)</span></span>
<span>                <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="fu"><a href="../reference/ConsF.html">ConsF</a></span> <span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="../reference/liftF.html">liftF</a></span> <span class="op">(</span><span class="fu"><a href="../reference/NilF.html">NilF</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>            <span class="kw">else</span> <span class="op">{</span></span>
<span>                <span class="va">x_</span> <span class="op">=</span> <span class="va">projected_</span><span class="op">$</span><span class="va">attr</span></span>
<span>                <span class="va">k_</span> <span class="op">=</span> <span class="va">projected_</span><span class="op">$</span><span class="va">carrier</span></span>
<span>                <span class="va">projected__</span> <span class="op">=</span> <span class="fu"><a href="../reference/project.html">project</a></span> <span class="op">(</span><span class="va">k_</span><span class="op">)</span></span>
<span>                </span>
<span>                <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="../reference/is.NilF.html">is.NilF</a></span> <span class="op">(</span><span class="va">projected__</span><span class="op">)</span><span class="op">)</span></span>
<span>                    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="fu"><a href="../reference/ConsF.html">ConsF</a></span> <span class="op">(</span><span class="va">x_</span>, <span class="fu"><a href="../reference/liftF.html">liftF</a></span> <span class="op">(</span><span class="fu"><a href="../reference/ConsF.html">ConsF</a></span> <span class="op">(</span><span class="va">x</span>, <span class="va">k_</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>                <span class="kw">else</span> <span class="op">{</span></span>
<span>                    <span class="va">x__</span> <span class="op">=</span> <span class="va">projected__</span><span class="op">$</span><span class="va">attr</span></span>
<span>                    <span class="va">k__</span> <span class="op">=</span> <span class="va">projected__</span><span class="op">$</span><span class="va">carrier</span></span>
<span>                    </span>
<span>                    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="fu"><a href="../reference/ConsF.html">ConsF</a></span> <span class="op">(</span><span class="va">x__</span>, <span class="fu"><a href="../reference/Free.html">Free</a></span> <span class="op">(</span><span class="fu"><a href="../reference/ConsF.html">ConsF</a></span> <span class="op">(</span><span class="va">x_</span>, <span class="fu"><a href="../reference/liftF.html">liftF</a></span> <span class="op">(</span><span class="fu"><a href="../reference/ConsF.html">ConsF</a></span> <span class="op">(</span><span class="va">x</span>, <span class="va">k__</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>                <span class="op">}</span></span>
<span>            <span class="op">}</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="fu"><a href="../reference/futu.html">futu</a></span> <span class="op">(</span><span class="va">coalg</span>, <span class="va">lst</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">exchange</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]]</span></span>
<span><span class="co">#&gt; [1] 6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[5]]</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[6]]</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[7]]</span></span>
<span><span class="co">#&gt; [1] 9</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[8]]</span></span>
<span><span class="co">#&gt; [1] 8</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[9]]</span></span>
<span><span class="co">#&gt; [1] 7</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by D Guthrie.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
